<page-layout>
  <div class="flex justify-center flex-1" *ngIf="!isLoading">
    <div>
      <h1 class="text-3xl text-center mb-8">Reset Your Password</h1>

      <div *ngIf="!success">
        <p class="text-gray-600 mb-6 text-center">
          Enter your username and we'll send you a link to reset your password.
        </p>

        <form class="w-full mt-8" #form="ngForm" (ngSubmit)="requestPasswordReset()" (keydown.enter)="requestPasswordReset()">
          <div class="flex flex-col mb-4">
            <input-field
              name="username"
              [label]="'Username'"
              class="col-span-2"
              [className]="'w-full col-span-2'"
              [type]="InputType.text"
              [(value)]="username"
              [form]="form"
            ></input-field>
            <div class="h-5">
              <div *ngIf="submitted && !username" class="text-xs text-red-600 mt-1">
                <p>Username is required!</p>
              </div>
            </div>
          </div>

          <simple-button className="w-full py-3 mt-2 font-semibold text-white rounded-lg" (click)="requestPasswordReset()">
            Send Reset Link
          </simple-button>

          <div class="flex justify-center mt-3">
            <a class="text-sm mr-1" [routerLink]="['/login']">Remember your password?</a>
            <a class="text-sm text-primary underline hover:text-primary-light" [routerLink]="['/login']">
              Log In
            </a>
          </div>
        </form>
      </div>

      <div *ngIf="success" class="text-center">
        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4">
          <p class="font-bold">Check your email!</p>
          <p class="text-sm mt-2">
            If an account exists with this username, you will receive an email with instructions to reset your password.
          </p>
        </div>

        <simple-button className="w-full py-3 mt-4 font-semibold text-white rounded-lg" [routerLink]="['/login']">
          Return to Login
        </simple-button>
      </div>
    </div>
  </div>

  <loading-spinner [isLoading]="isLoading"></loading-spinner>
</page-layout>
